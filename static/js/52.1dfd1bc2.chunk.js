(this.webpackJsonppropetypro=this.webpackJsonppropetypro||[]).push([[52],{556:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(0),r=a.n(n),l=a(199),i=a(526),c=a(129),m=a(527),o=a(529),s=a(453),u=a(64),d=Object(l.a)((function(e){return{root:{display:"flex",alignItems:"center",height:80,width:120},wrapper:{margin:e.spacing(1),position:"relative",height:50,width:50},buttonProgress:{color:c.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}));function f(e){var t=e.open,a=e.dialogTitle,n=d();return r.a.createElement(m.a,{maxWidth:"md","aria-labelledby":"simple-dialog-title",open:t},r.a.createElement(o.a,null,r.a.createElement(s.a,{container:!0,alignItems:"center",direction:"column"},r.a.createElement(s.a,{item:!0,lg:!0},r.a.createElement(u.a,null,a||"Saving...")),r.a.createElement(s.a,{item:!0,lg:!0},r.a.createElement("div",{className:n.root},r.a.createElement("div",{className:n.wrapper},t&&r.a.createElement(i.a,{size:50,className:n.buttonProgress})))))))}},696:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(453),i=a(203),c=a(202),m=a(41),o=a(10),s=a.n(o),u=a(20),d=a(44),f=a(714),E=a(683),p=a(693),b=a(525),g=a(541),h=a(64),v=a(524),_=a(558),S=a.n(_),j=a(55),k=a(11),T=a(452),y=a(508),O=a(509),C=a(571),x=a(179),I=a(507),N=a(46);function w(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))}function q(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))}function B(e){var t=Object(N.a)(),a=e.contacts,i=e.users,c=e.contactToSendEmailTo,m=e.contactSource,o=e.submitEmailSourceValues,s=e.handleBack,u=r.a.useState([]),f=Object(d.a)(u,2),E=f[0],p=f[1],_=r.a.useState([]),S=Object(d.a)(_,2),j=S[0],B=S[1],U=r.a.useState([]),z=Object(d.a)(U,2),W=z[0],D=z[1],F=r.a.useState("Tenants"),P=Object(d.a)(F,2),R=P[0],V=P[1];Object(n.useEffect)((function(){B(a),V("Tenants")}),[a]),Object(n.useEffect)((function(){p([c]),V(m)}),[c]),Object(n.useEffect)((function(){B(i),V("Users")}),[i]);var M=q(E,j),L=q(E,W),J=function(e){return function(){var t=E.indexOf(e),a=Object(k.a)(E);-1===t?a.push(e):a.splice(t,1),p(a)}},H=function(e){return r.a.createElement(x.a,{className:t.paper},r.a.createElement(I.a,{dense:!0,component:"div",role:"list"},e.map((function(e,t){var a="transfer-list-item-".concat(t,"-label");return r.a.createElement(T.a,{key:t,role:"listitem",button:!0,onClick:J(e)},r.a.createElement(y.a,null,r.a.createElement(C.a,{checked:-1!==E.indexOf(e),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":a}})),r.a.createElement(O.a,{id:a,primary:"".concat(e.first_name," ").concat(e.last_name)}))})),r.a.createElement(T.a,null)))};return r.a.createElement(l.a,{container:!0,spacing:2,direction:"column",className:t.root},r.a.createElement(l.a,{item:!0,container:!0,alignItems:"center",direction:"column",spacing:2},r.a.createElement(l.a,{item:!0},r.a.createElement(h.a,{variant:"subtitle1"},W.length>=1?"".concat(W.length," ").concat(R," selected"):"Select ".concat(R," to send email"))),r.a.createElement(l.a,{item:!0},r.a.createElement(g.a,{fullWidth:!0,select:!0,onChange:function(e){switch(V(e.target.value),e.target.value){case"Tenants":B(a),D([]),p([]);break;case"Users":B(i),D([]),p([])}},variant:"outlined",label:"Select Emails Source",value:R},["Tenants","Users"].map((function(e,t){return r.a.createElement(v.a,{key:t,value:e},e)})))),r.a.createElement(l.a,{item:!0,container:!0,direction:"row",spacing:2},r.a.createElement(l.a,{item:!0,sm:!0},H(j)),r.a.createElement(l.a,{item:!0,sm:4,container:!0,direction:"column",spacing:1,alignItems:"center"},r.a.createElement(l.a,{item:!0},r.a.createElement(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){D(W.concat(j)),B([])},disabled:0===j.length,"aria-label":"move all right"},"\u226b")),r.a.createElement(l.a,{item:!0},r.a.createElement(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){D(W.concat(M)),B(w(j,M)),p(w(E,M))},disabled:0===M.length,"aria-label":"move selected right"},">")),r.a.createElement(l.a,{item:!0},r.a.createElement(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){B(j.concat(L)),D(w(W,L)),p(w(E,L))},disabled:0===L.length,"aria-label":"move selected left"},"<")),r.a.createElement(l.a,{item:!0},r.a.createElement(b.a,{variant:"outlined",size:"small",className:t.button,onClick:function(){B(j.concat(W)),D([])},disabled:0===W.length,"aria-label":"move all left"},"\u226a"))),r.a.createElement(l.a,{item:!0,sm:!0},H(W)))),r.a.createElement(l.a,{item:!0,container:!0,spacing:2},r.a.createElement(l.a,{item:!0},r.a.createElement(b.a,{onClick:s,variant:"contained"},"Back")),r.a.createElement(l.a,{item:!0},r.a.createElement(b.a,{disabled:!W.length,onClick:function(){o("Tenants"===R?W.map((function(e){return e.contact_email})):W.map((function(e){return e.primary_email})))},variant:"contained",color:"primary"},"Send"))))}var U=a(37),z=a(611),W=a.n(z),D=(a(617),a(19)),F=a(556),P=D.e().shape({from_user:D.g().required("From User is required"),email_subject:D.g().trim().required("Email Subject Required"),email_message:D.g().trim().required("Email Message is Required")}),R={toolbar:[[{header:[1,2,3,4,5,6,!1]},{font:[]}],[{size:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link"],["clean"]],clipboard:{matchVisual:!1}},V=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","video"];function M(e){var t=e.currentUser,a=e.contactToSendEmailTo,n=e.contactSource,i=e.users,c=e.contacts,m=e.history,o=e.emailTemplates,_=e.handleItemSubmit,k=Object(N.a)(),T=r.a.useState(0),y=Object(d.a)(T,2),O=y[0],C=y[1],x={from_user:t.email||"",email_subject:"",email_message:"",template:""},I=r.a.useState(x),w=Object(d.a)(I,2),q=w[0],z=w[1],D=r.a.useState(!1),M=Object(d.a)(D,2),L=M[0],J=M[1],H=["Create an email","Select an email group"],A=function(){C((function(e){return e+1}))},G=function(){m.goBack()},K=function(){var e=Object(u.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J(!0),e.next=3,Object(U.k)(q.from_user,q.email_subject,q.email_message,t);case 3:return a={email_subject:q.email_subject,from_user:q.from_user,date_sent:(new Date).toDateString()},e.next=6,_(a,"communication_emails");case 6:J(!1),A();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:k.fullHeightWidthContainer},L&&r.a.createElement(F.a,{dialogTitle:"Sending email...",open:!0}),r.a.createElement(f.a,{activeStep:O},H.map((function(e,t){return r.a.createElement(E.a,{key:e},r.a.createElement(p.a,null,e))}))),r.a.createElement("div",null,O===H.length?r.a.createElement("div",null,r.a.createElement(h.a,{className:k.oneMarginTopBottom},"Email Sent..."),r.a.createElement(b.a,{onClick:function(){z(x),C(0)},className:k.oneMarginRight},"Reset")):0===O?r.a.createElement(l.a,{container:!0,direction:"column"},r.a.createElement(j.b,{initialValues:q,validationSchema:P,onSubmit:function(e){!function(e){z(e),A()}({from_user:e.from_user,email_subject:e.email_subject,email_message:e.email_message})}},(function(e){var t=e.values,a=e.handleSubmit,n=e.touched,i=e.setFieldValue,c=e.errors,m=e.handleChange,s=e.handleBlur;return r.a.createElement("form",{className:k.form,method:"post",id:"emailDetailsInputForm",onSubmit:a},r.a.createElement(l.a,{container:!0,spacing:2,justify:"center",alignItems:"stretch",direction:"column"},r.a.createElement(l.a,{item:!0},r.a.createElement(g.a,{InputLabelProps:{shrink:!0},fullWidth:!0,variant:"outlined",id:"from_user",name:"from_user",label:"From:",value:t.from_user,onChange:m,onBlur:s,error:c.from_user&&n.from_user,helperText:c.from_user})),r.a.createElement(l.a,{item:!0},r.a.createElement(g.a,{fullWidth:!0,select:!0,variant:"outlined",id:"template",name:"template",label:"Template",value:t.template,onChange:function(e){var t=o.find((function(t){return t.id===e.target.value}))||{};i("template",e.target.value),i("email_message",t.template_contents)},onBlur:s,error:c.template&&n.template,helperText:c.template},o.map((function(e,t){return r.a.createElement(v.a,{key:t,value:e.id},e.template_name)})))),r.a.createElement(l.a,{item:!0},r.a.createElement(g.a,{fullWidth:!0,InputLabelProps:{shrink:!0},variant:"outlined",id:"email_subject",name:"email_subject",label:"Email Subject",value:t.email_subject,onChange:m,onBlur:s,error:c.email_subject&&n.email_subject,helperText:n.email_subject&&c.email_subject})),r.a.createElement(l.a,{item:!0},r.a.createElement(h.a,{color:"textSecondary",variant:"body1",paragraph:!0},"Email Message"),r.a.createElement(W.a,{className:k.quillEditor,value:t.email_message,onChange:function(e){i("email_message",e)},theme:"snow",modules:R,formats:V})),r.a.createElement(l.a,{item:!0,container:!0,spacing:2},r.a.createElement(l.a,{item:!0},r.a.createElement(b.a,{color:"secondary",variant:"contained",size:"medium",startIcon:r.a.createElement(S.a,null),onClick:G,disableElevation:!0},"Cancel")),r.a.createElement(l.a,{item:!0},r.a.createElement(b.a,{form:"emailDetailsInputForm",type:"submit",variant:"contained",color:"primary"},"Next")))))}))):1===O?r.a.createElement(B,{contacts:c,users:i,handleBack:function(){C((function(e){return e-1}))},contactToSendEmailTo:a,contactSource:n,submitEmailSourceValues:K}):null))}var L=a(25),J=a(213),H=a.n(J),A=function(e){var t=e.users,a=e.currentUser,n=e.contacts,m=e.emailTemplates,o=e.handleItemSubmit,s=H.a.parse(e.location.search),u=s.contact,d=s.contactSource,f=t.find((function(e){return e.id===u}));return r.a.createElement(c.a,{pageTitle:"Email Campaign Details"},r.a.createElement(l.a,{container:!0,justify:"center",direction:"column"},r.a.createElement(l.a,{item:!0,key:2},r.a.createElement(i.a,{text:"Compose Email"})),r.a.createElement(l.a,{container:!0,direction:"column",justify:"center",item:!0,key:3},r.a.createElement(M,{contactToSendEmailTo:f,contactSource:d,currentUser:a,contacts:n,history:e.history,users:t,emailTemplates:m,handleItemSubmit:o}))))};A=Object(m.b)((function(e){return{contacts:e.contacts,currentUser:e.currentUser,emailTemplates:e.emailTemplates,users:e.users}}),(function(e){return{handleItemSubmit:function(t,a){return e(Object(U.h)(t,a))}}}))(A);t.default=Object(L.g)(A)}}]);
//# sourceMappingURL=52.1dfd1bc2.chunk.js.map