(this.webpackJsonppropetypro=this.webpackJsonppropetypro||[]).push([[26],{545:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r(17),n=r(9),i=r(7);function u(e,t){Object(i.a)(2,arguments);var r=Object(n.a)(e),u=Object(a.a)(t);if(isNaN(u))return new Date(NaN);if(!u)return r;var c=r.getDate(),o=new Date(r.getTime());o.setMonth(r.getMonth()+u+1,0);var l=o.getDate();return c>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),c),r)}},549:function(e,t,r){"use strict";r.d(t,"b",(function(){return b})),r.d(t,"e",(function(){return y})),r.d(t,"d",(function(){return O})),r.d(t,"p",(function(){return j})),r.d(t,"m",(function(){return E})),r.d(t,"n",(function(){return x})),r.d(t,"j",(function(){return M})),r.d(t,"i",(function(){return T})),r.d(t,"l",(function(){return C})),r.d(t,"o",(function(){return S})),r.d(t,"f",(function(){return R})),r.d(t,"h",(function(){return W})),r.d(t,"q",(function(){return k})),r.d(t,"c",(function(){return F})),r.d(t,"g",(function(){return q})),r.d(t,"k",(function(){return w})),r.d(t,"a",(function(){return D}));var a=r(512),n=r(513),i=r(514),u=r(515),c=r(572),o=r(573),l=r(574),d=r(575),s=Object(a.a)({start:Object(n.a)(Object(i.a)()),end:Object(u.a)(Object(i.a)())}),m=["Mr","Prof","Hon","Sir","Mrs","Miss","Dr","Madam","Other"],p=["Male","Female","Unspecified"],f=["Security Deposit Refund","Water Deposit Refund","Management Fees","Utilities","Taxes","Mortgage","Office","Maintenance & Cleaning","Advertising","Insurance","Legal & Other Professional Fees","Auto & Travel","Supplies","Other Refund","Repairs","Other"],_=["Bed Sitter","One Bedroom","Two Bedroom","Single Room","Double Room","Shop","Other"],g=["Fixed","Fixed w/rollover"],h=["Electric","Sewer","Water"],v=["Daily","Weekly","Monthly","Quarterly","Half-Yearly","Yearly"];function b(){return m}function y(){return p}function O(){return f}function j(){return _}function E(){for(var e=[],t=1;t<=5;t++)e.push(t);return e.concat("5+")}function x(){for(var e=[],t=1;t<=5;t++)e.push(t);return e}function M(){return h}function T(){return g}function C(){return v}function S(){return[{id:"month-to-date",text:"Month To Date"},{id:"last-month",text:"Last Month"},{id:"3-months-to-date",text:"3 Months To Date"},{id:"year-to-date",text:"Year To Date"},{id:"last-year",text:"Last Year"}]}function R(){return[Object(c.a)(Object(o.a)(Object(i.a)(),1)),Object(l.a)(Object(o.a)(Object(i.a)(),1))]}function W(){return[Object(n.a)(Object(d.a)(Object(i.a)(),1)),Object(u.a)(Object(d.a)(Object(i.a)(),1))]}function k(){return[Object(n.a)(Object(i.a)()),Object(i.a)()]}function F(){return[Object(c.a)(Object(i.a)()),Object(l.a)(Object(i.a)())]}function q(){return[Object(c.a)(Object(o.a)(Object(i.a)(),2)),Object(l.a)(Object(i.a)())]}function w(){return s}var D=new Intl.NumberFormat(void 0,{style:"decimal",currency:"KES"})},556:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var a=r(0),n=r.n(a),i=r(199),u=r(526),c=r(129),o=r(527),l=r(529),d=r(453),s=r(64),m=Object(i.a)((function(e){return{root:{display:"flex",alignItems:"center",height:80,width:120},wrapper:{margin:e.spacing(1),position:"relative",height:50,width:50},buttonProgress:{color:c.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}));function p(e){var t=e.open,r=e.dialogTitle,a=m();return n.a.createElement(o.a,{maxWidth:"md","aria-labelledby":"simple-dialog-title",open:t},n.a.createElement(l.a,null,n.a.createElement(d.a,{container:!0,alignItems:"center",direction:"column"},n.a.createElement(d.a,{item:!0,lg:!0},n.a.createElement(s.a,null,r||"Saving...")),n.a.createElement(d.a,{item:!0,lg:!0},n.a.createElement("div",{className:a.root},n.a.createElement("div",{className:a.wrapper},t&&n.a.createElement(u.a,{size:50,className:a.buttonProgress})))))))}},557:function(e,t,r){"use strict";var a=r(14);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(0)),i=(0,a(r(15)).default)(n.default.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");t.default=i},558:function(e,t,r){"use strict";var a=r(14);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(0)),i=(0,a(r(15)).default)(n.default.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");t.default=i},572:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r(9),n=r(7);function i(e){Object(n.a)(1,arguments);var t=Object(a.a)(e);return t.setDate(1),t.setHours(0,0,0,0),t}},573:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r(17),n=r(545),i=r(7);function u(e,t){Object(i.a)(2,arguments);var r=Object(a.a)(t);return Object(n.a)(e,-r)}},574:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r(9),n=r(7);function i(e){Object(n.a)(1,arguments);var t=Object(a.a)(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}},575:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var a=r(17),n=r(545),i=r(7);function u(e,t){Object(i.a)(2,arguments);var r=Object(a.a)(t);return Object(n.a)(e,12*r)}function c(e,t){Object(i.a)(2,arguments);var r=Object(a.a)(t);return u(e,-r)}},712:function(e,t,r){"use strict";r.r(t);var a=r(97),n=r(0),i=r.n(n),u=r(453),c=r(203),o=r(202),l=r(41),d=r(10),s=r.n(d),m=r(20),p=r(525),f=r(541),_=r(524),g=r(208),h=r(55),v=r(46),b=r(557),y=r.n(b),O=r(558),j=r.n(O),E=r(549),x=r(19),M=r(537),T=r(514),C=r(556),S=Object(M.a)(Object(T.a)(),"yyyy-MM-dd"),R=x.e().shape({meter_type:x.g().trim().required("Meter Reading is required"),prior_value:x.d().required("Prior Value is required").positive("Amount must be a positive number"),current_value:x.d().min(x.f("prior_value"),"Current Value must be greater than prior value").required("Current Value is required"),unit_charge:x.d().positive("Amount must be a positive number").required("Unit Charge is Required"),base_charge:x.d().positive("Amount must be a positive number").default(0),reading_date:x.c().required("Reading Date Required"),property_id:x.g().trim().required("Property is Required"),unit_id:x.g().trim().required("Unit is Required")}),W=Object(E.j)(),k=function(e){var t=e.properties,r=e.unitsWithActiveLeases,a=e.history,n=e.meterReadingToEdit,c=e.handleItemSubmit,o=Object(v.a)(),l={id:n.id,property_id:n.property_id||"",unit_id:n.unit_id||"",reading_date:n.reading_date||S,prior_value:n.prior_value||"",current_value:n.current_value||"",base_charge:n.base_charge||"",unit_charge:n.unit_charge||"",meter_type:n.meter_type||"",tenant_id:n.tenant_id||""};return i.a.createElement(h.b,{initialValues:l,enableReinitialize:!0,validationSchema:R,onSubmit:function(){var e=Object(m.a)(s.a.mark((function e(t,n){var i,u,o,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.resetForm,u=n.setStatus,e.prev=1,(o={id:t.id,meter_type:t.meter_type,prior_value:t.prior_value,current_value:t.current_value,base_charge:t.base_charge,unit_charge:t.unit_charge,unit_id:t.unit_id,property_id:t.property_id,tenant_id:r.find((function(e){return e.id===t.unit_id})).tenant_id,reading_date:t.reading_date}).usage=t.current_value-t.prior_value,o.amount=o.usage*parseFloat(t.unit_charge)+parseFloat(t.base_charge),e.next=7,c(o,"meter_readings");case 7:if(t.id){e.next=11;break}return l={charge_amount:o.amount,charge_date:S,charge_label:"".concat(t.meter_type," Charge"),charge_type:"meter_type",due_date:S,tenant_id:o.tenant_id,unit_id:t.unit_id,property_id:t.property_id},e.next=11,c(l,"transactions-charges");case 11:i({}),t.id&&a.goBack(),u({sent:!0,msg:"Meter reading and charge saved."}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),u({sent:!1,msg:"Error! ".concat(e.t0,".")});case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t,r){return e.apply(this,arguments)}}()},(function(e){var n=e.values,c=e.status,l=e.handleSubmit,d=e.setFieldValue,s=e.errors,m=e.touched,h=e.handleChange,v=e.handleBlur,b=e.isSubmitting;return i.a.createElement("form",{className:o.form,method:"post",id:"meterInputForm",onSubmit:l},i.a.createElement(u.a,{container:!0,spacing:2,justify:"center",alignItems:"stretch",direction:"column"},c&&c.msg&&i.a.createElement(g.a,{variant:c.sent?"success":"error",message:c.msg}),b&&i.a.createElement(C.a,{open:!0}),i.a.createElement(u.a,{item:!0,container:!0,direction:"row",spacing:2},i.a.createElement(u.a,{item:!0,xs:12,md:6},i.a.createElement(f.a,{fullWidth:!0,select:!0,variant:"outlined",name:"property_id",label:"Property",id:"property_id",onChange:function(e){d("property_id",e.target.value),d("unit_id","")},value:n.property_id,error:s.property_id&&m.property_id,helperText:m.property_id&&s.property_id},t.map((function(e,t){return i.a.createElement(_.a,{key:t,value:e.id},e.ref)})))),i.a.createElement(u.a,{item:!0,xs:12,md:6},i.a.createElement(f.a,{fullWidth:!0,select:!0,variant:"outlined",name:"unit_id",label:"Unit",id:"unit_id",onChange:h,value:n.unit_id,error:s.unit_id&&m.unit_id,helperText:m.unit_id&&s.unit_id},r.filter((function(e){return e.property_id===n.property_id})).map((function(e,t){return i.a.createElement(_.a,{key:t,value:e.id},e.ref)}))))),i.a.createElement(u.a,{item:!0},i.a.createElement(f.a,{fullWidth:!0,type:"date",InputLabelProps:{shrink:!0},variant:"outlined",id:"reading_date",name:"reading_date",label:"Reading Date",value:n.reading_date,onChange:h,onBlur:v,error:s.reading_date&&m.reading_date,helperText:m.reading_date&&s.reading_date})),i.a.createElement(u.a,{item:!0},i.a.createElement(f.a,{fullWidth:!0,select:!0,variant:"outlined",id:"meter_type",name:"meter_type",label:"Meter Type",value:n.meter_type,onChange:h,onBlur:v,error:s.meter_type&&m.meter_type,helperText:m.meter_type&&s.meter_type},W.map((function(e,t){return i.a.createElement(_.a,{key:t,value:e},e)})))),i.a.createElement(u.a,{item:!0},i.a.createElement(f.a,{fullWidth:!0,variant:"outlined",id:"prior_value",name:"prior_value",label:"Prior Value",value:n.prior_value,onChange:h,onBlur:v,error:s.prior_value&&m.prior_value,helperText:m.prior_value&&s.prior_value})),i.a.createElement(u.a,{item:!0},i.a.createElement(f.a,{fullWidth:!0,variant:"outlined",id:"current_value",name:"current_value",label:"Current Value",value:n.current_value,onChange:h,onBlur:v,error:s.current_value&&m.current_value,helperText:m.current_value&&s.current_value})),i.a.createElement(u.a,{item:!0},i.a.createElement(f.a,{fullWidth:!0,disabled:!0,variant:"outlined",id:"usage",name:"usage",label:"Usage",value:n.current_value-n.prior_value})),i.a.createElement(u.a,{item:!0},i.a.createElement(f.a,{fullWidth:!0,variant:"outlined",id:"base_charge",name:"base_charge",label:"Base Charge",value:n.base_charge,onChange:h,onBlur:v,error:s.base_charge&&m.base_charge,helperText:m.base_charge&&s.base_charge})),i.a.createElement(u.a,{item:!0},i.a.createElement(f.a,{fullWidth:!0,variant:"outlined",id:"unit_charge",name:"unit_charge",label:"Unit Charge",value:n.unit_charge,onChange:h,onBlur:v,error:s.unit_charge&&m.unit_charge,helperText:m.unit_charge&&s.unit_charge})),i.a.createElement(u.a,{item:!0,container:!0,className:o.buttonBox},i.a.createElement(u.a,{item:!0},i.a.createElement(p.a,{color:"secondary",variant:"contained",size:"medium",startIcon:i.a.createElement(j.a,null),onClick:function(){return a.goBack()},disableElevation:!0},"Cancel")),i.a.createElement(u.a,{item:!0},i.a.createElement(p.a,{type:"submit",color:"primary",variant:"contained",size:"medium",startIcon:i.a.createElement(y.a,null),form:"meterInputForm",disabled:b},"Save")))))}))},F=r(25),q=r(37),w=function(e){var t=e.history,r=e.meterReadingToEdit,a=e.contacts,n=e.unitsWithActiveLeases,l=e.properties,d=e.handleItemSubmit,s="Charge Tenant for Meter Reading";return i.a.createElement(o.a,{pageTitle:s},i.a.createElement(u.a,{container:!0,justify:"center",direction:"column"},i.a.createElement(u.a,{item:!0,key:1},i.a.createElement(c.a,{text:s})),i.a.createElement(u.a,{item:!0,key:2},i.a.createElement(k,{meterReadingToEdit:r,handleItemSubmit:d,contacts:a,history:t,properties:l,unitsWithActiveLeases:n}))))};w=Object(l.b)((function(e,t){var r=e.leases.filter((function(e){return!0!==e.terminated})).map((function(t){return Object(a.a)(Object(a.a)({},e.propertyUnits.find((function(e){return e.id===t.unit_id}))),{},{tenant_id:Array.isArray(t.tenants)?t.tenants[0]:""})}));return{properties:e.properties,unitsWithActiveLeases:r,meterReadingToEdit:e.meterReadings.find((function(e){return e.id===t.match.params.meterReadingId}))||{}}}),(function(e){return{handleItemSubmit:function(t,r){return e(Object(q.h)(t,r))}}}))(w);t.default=Object(F.g)(w)}}]);
//# sourceMappingURL=26.067f114e.chunk.js.map